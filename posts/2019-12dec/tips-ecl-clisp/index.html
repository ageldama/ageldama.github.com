<!DOCTYPE html>
<html><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><title>커먼리습 설정하기, ASDF 시스템 코드를 받기 - 아겔로그</title><meta name="hugo-gen-timestamp" content="1771409348">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="view-transition" content="same-origin">
    <meta name="description" content="1. ASDF을 최신 버젼으로 설정한다
(이부분에서 많이 고생했는데) SBCL와 다르게
CLISP,
ECL 은 최신 버젼의 ASDF을
내장한걸 패키징해놓지 않았다.
대부분은 문제가 없이 동작하지만, 내가 작성한 커먼리습 시스템에서
실행파일을 빌드할 때 문제가 많았다.

ASDF 의 최신 버젼을 git clone 해서 적당한 디렉토리에 받는다.

https://common-lisp.net/project/asdf/


make을 내려받은 ASDF 디렉토리에서 실행한다.

실행하면 build/asdf.lisp 파일으로 한 파일으로 뭉쳐서 로딩하게
편안한 파일을 생성해준다.


내 커먼리습 구현체의 시작설정파일 맨 앞에 다음처럼 추가한다.

(load &quot;~/local/asdf/build/asdf&quot;)

여기서 나는 $HOME/local/asdf/ 에 ASDF을 받았다고 가정.
그리고 asdf.lisp 파일이더라도, 마지막에 .lisp 확장자는 생략했다.


ECL은 $HOME/.eclrc
CLISP은 $HOME/.clisprc.lisp


그리고 중요한데, 그 다음에
Quicklisp 초기화 내용이 오도록
한다.

Quicklisp을 초기화하기 전에 ASDF 최신 버젼이 로딩되어 있는게 더
나을테니까.
어차피 위의 (1~3)의 순서대로 ASDF 먼저 설정한 다음에
Quicklisp설치한 다음에 ql:add-to-init-file 실행하면 이런
순서로 추가해준다.



&hellip;별거 아닌데, 이거 때문에 빌드한 결과 실행파일이 이상해서 좀 고생했다." />
    <meta property="og:image" content=""/>
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/styles.cf6e224503e8604b8cfea063150685f5d1e1e66e9d4705693ef0163e1c529e7d.css"
          integrity="sha256-z24iRQPoYEuM/qBjFQaF9dHh5m6dRwVpPvAWPhxSnn0=" crossorigin="anonymous">
    
    
    
    
    

        
        
        
            
                
                    <script src="/js/bundle.c11f553788e500f0664c8f4de6cd61b730fc0e27c6d1809bc240d1cd7abfdcde.js" integrity="sha256-wR9VN4jlAPBmTI9N5s1htzD8DifG0YCbwkDRzXq/3N4=" crossorigin="anonymous"></script>
                
            
        
    

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Noto+Sans+KR:wght@100..900&family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&family=Nanum+Gothic+Coding&family=Noto+Sans+KR:wght@100..900&family=Noto+Serif+KR:wght@200..900&display=swap" rel="stylesheet">
</head>
<body hx-boost="true" hx-indicator=".htmx-indicator">
        <div class="htmx-indicator"><div class="spinner"></div></div>

        <div class="container"><header>
    <div class="main ">
        <h1 class="site-title ">
            <a href="https://ageldama.github.io/">아겔로그</a>
        </h1>
    </div>

    <nav>
        
          <div class="search-form">
      <span class="search-loading-indicator" style="display: none;"></span>
      <input id="search-query" name="search-query"
          type="text"
          class="search-query"
          tabindex="1"
          placeholder="🔎 검색 (search)"
          onkeyup="searcher.onSearchKeyup(event)"/>
  </div>

        

        
        <a href="/series/">📚 Series</a>
        
        <a href="/archive/">🗂️ Archive</a>
        
        <a href="/myself/">📨 Contact</a>
        

        
        <button class="dark-mode-btn"
        aria-label="toggle dark-mode"
        onclick="colorscheme.toggle()">color: </button>
<!--button class="snow-mode-btn"
        aria-label="toggle dark-mode"
        onclick="letitsnow(event)">☃️ snow?</button-->

        
    </nav>
</header>





<script>
 
 if (window.navigator.userAgent.indexOf('Trident/') > 0) {
     let urls = [];
     let head = document.getElementsByTagName("head")[0];
     urls.forEach(function(url) {
         let script = document.createElement("script");
         script.src = url;
         head.appendChild(script);
     });
 }
 
</script>

<div class="search">
    <div class="search-results"></div>
</div>


<main>
    <nav class="post-prevnext" aria-label="posts">
    <span class="post-prevnext-side">
        
        <a class="post-prevnext-btn" href="https://ageldama.github.io/posts/2019-12dec/cl-state-machine-1st-release/">⬅️ First release of cl-state-machine</a>
        
    </span>

    <span class="post-prevnext-side">
        
        <a class="post-prevnext-btn" href="https://ageldama.github.io/posts/2019-11nov/the-dark-side-of-cl-equality/">➡️ (Common Lisp의 어두운 면) Equality</a>
        
    </span>
</nav>

    
    <hr class="archive-ruler">
    
    <nav id="TableOfContents">
  <ul>
    <li><a href="#1-asdf을-최신-버젼으로-설정한다">1. ASDF을 최신 버젼으로 설정한다</a></li>
    <li><a href="#2-asdf-로딩하는-디렉토리를-알거나-설정한다">2. ASDF 로딩하는 디렉토리를 알거나, 설정한다</a></li>
    <li><a href="#3-처음-받은-asdf시스템은-quicklisp으로-로딩한다">3. 처음 받은 ASDF시스템은 Quicklisp으로 로딩한다</a></li>
    <li><a href="#끝">끝</a></li>
  </ul>
</nav>

    <article>
	<div class="title"><h1 class="title">👩‍🦽 커먼리습 설정하기, ASDF 시스템 코드를 받기</h1>
	    <div class="meta">
                <time datetime="2019-12-06" pubdate>
                    2019년12월06일
                </time>
                </div>
        </div>

        

	

	<section class="body">
	    <h1 id="1-asdf을-최신-버젼으로-설정한다">1. ASDF을 최신 버젼으로 설정한다</h1>
<p>(이부분에서 많이 고생했는데) SBCL와 다르게
<a href="https://clisp.sourceforge.io/">CLISP</a>,
<a href="https://common-lisp.net/project/ecl/">ECL</a> 은 최신 버젼의 ASDF을
내장한걸 패키징해놓지 않았다.</p>
<p>대부분은 문제가 없이 동작하지만, 내가 작성한 커먼리습 시스템에서
실행파일을 빌드할 때 문제가 많았다.</p>
<ol>
<li>ASDF 의 최신 버젼을 <code>git clone</code> 해서 적당한 디렉토리에 받는다.
<ul>
<li><a href="https://common-lisp.net/project/asdf/">https://common-lisp.net/project/asdf/</a></li>
</ul>
</li>
<li><code>make</code>을 내려받은 ASDF 디렉토리에서 실행한다.
<ul>
<li>실행하면 <code>build/asdf.lisp</code> 파일으로 한 파일으로 뭉쳐서 로딩하게
편안한 파일을 생성해준다.</li>
</ul>
</li>
<li>내 커먼리습 구현체의 시작설정파일 맨 앞에 다음처럼 추가한다.
<ul>
<li><code>(load &quot;~/local/asdf/build/asdf&quot;)</code>
<ul>
<li>여기서 나는 <code>$HOME/local/asdf/</code> 에 ASDF을 받았다고 가정.</li>
<li>그리고 <code>asdf.lisp</code> 파일이더라도, 마지막에 <code>.lisp</code> 확장자는 생략했다.</li>
</ul>
</li>
<li>ECL은 <code>$HOME/.eclrc</code></li>
<li>CLISP은 <code>$HOME/.clisprc.lisp</code></li>
</ul>
</li>
<li>그리고 중요한데, 그 다음에
<a href="https://www.quicklisp.org/">Quicklisp</a> 초기화 내용이 오도록
한다.
<ul>
<li>Quicklisp을 초기화하기 전에 ASDF 최신 버젼이 로딩되어 있는게 더
나을테니까.</li>
<li>어차피 위의 (1~3)의 순서대로 ASDF 먼저 설정한 다음에
Quicklisp설치한 다음에 <code>ql:add-to-init-file</code> 실행하면 이런
순서로 추가해준다.</li>
</ul>
</li>
</ol>
<p>&hellip;별거 아닌데, 이거 때문에 빌드한 결과 실행파일이 이상해서 좀 고생했다.</p>
<p>참고: <a href="https://github.com/ageldama/cl-state-machine/blob/master/build-tamagochi-exec-ecl.sh">https://github.com/ageldama/cl-state-machine/blob/master/build-tamagochi-exec-ecl.sh</a></p>
<h1 id="2-asdf-로딩하는-디렉토리를-알거나-설정한다">2. ASDF 로딩하는 디렉토리를 알거나, 설정한다</h1>
<p><a href="/posts/2018-11nov/cl-asdf-custom-load-script/">예전에도 언급</a>한 내용이다.</p>
<ol>
<li>ASDF 매뉴얼에서 나오는 항목들을 잘 읽어본다:
<ol>
<li>내 마음에 드는 위치에서 로딩하도록 설정하거나, 기본값으로 어디에서 로딩하는지 이해한다.
<ul>
<li>(매뉴얼) 기본 검색 위치 : <a href="https://common-lisp.net/project/asdf/asdf.html#Controlling-where-ASDF-searches-for-systems">https://common-lisp.net/project/asdf/asdf.html#Controlling-where-ASDF-searches-for-systems</a></li>
<li>(매뉴얼) 설정 방법 : <a href="https://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF-to-find-your-systems">https://common-lisp.net/project/asdf/asdf.html#Configuring-ASDF-to-find-your-systems</a></li>
<li>내 설정 파일 : <a href="https://github.com/ageldama/configs/blob/master/emacs/sly/source-registry.conf">https://github.com/ageldama/configs/blob/master/emacs/sly/source-registry.conf</a></li>
</ul>
</li>
</ol>
</li>
</ol>
<h1 id="3-처음-받은-asdf시스템은-quicklisp으로-로딩한다">3. 처음 받은 ASDF시스템은 Quicklisp으로 로딩한다</h1>
<p>조금 이상하다고 생각하는 부분.</p>
<p>처음으로 asdf 시스템인 프로젝트를 체크아웃 받아서 로딩하거나 테스트를 실행할 때,</p>
<p><code>(asdf:load-system :foobar)</code>와 같이 로딩하려 하지말고,</p>
<p><code>(ql:quickload :foobar)</code>와 같이 Quicklisp을 이용해서 로딩해라. 어차피
Quicklisp이 ASDF이랑 연결되어 있어서 로딩하고, 또 해당 시스템이
참조하는 Quicklisp 의존성들도 이렇게 해야지 제대로 로딩.</p>
<p>그리고 테스트 시스템도 마찬가지로 <code>(ql:quickload :foobar-tests)</code>와
같이 로딩한 다음에야 <code>(asdf:test-system :foobar)</code> 혹은
<code>(asdf:test-system :foobar-tests)</code>으로 실행해라.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h1 id="끝">끝</h1>
<p><a href="https://github.com/ageldama/cl-state-machine/">https://github.com/ageldama/cl-state-machine/</a> 작업하며 많은 팁들이
쌓인거 같다. ASDF와 테스트suites 연결하기, ASDF으로 실행파일 만들기
같은 것들에 대한 노하우도 많이 쌓았다.</p>
<p>이런 저런 노하우들을 정리해서 블로깅을 조금씩 해나가야지.</p>
<hr>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><code>foobar</code> 의 defsystem 선언에 <code>:in-order-to ((test-op (test-op &quot;foobar-tests&quot;)))</code>으로 테스트 시스템과 연결되어 있다면,
<code>(asdf:test-system :foobar)</code>해도 자동으로 <code>foobar-tests</code>의
테스트들을 실행하겠지.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

	</section><div class="post-tags">
	    
	    
	    <nav class="nav tags">
		<ul class="tags">
		    
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/lisp/">lisp</a>
                        <sup>26</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/commonlisp/">commonlisp</a>
                        <sup>20</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/common-lisp/">common-lisp</a>
                        <sup>19</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/asdf/">asdf</a>
                        <sup>4</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/quicklisp/">quicklisp</a>
                        <sup>2</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/clisp/">clisp</a>
                        <sup>1</sup>
                    </li>
		    
		    <li class="tagbutton-inline">
                        🏷️ <a href="/tags/ecl/">ecl</a>
                        <sup>1</sup>
                    </li>
		    
		</ul>
	    </nav>
	    
	    
	</div>
    </article>

    <hr class="archive-ruler">

    <style>
     :root {--bg-big-emoji: "👩‍🦽";}
    </style>

    <nav class="post-prevnext" aria-label="posts">
    <span class="post-prevnext-side">
        
        <a class="post-prevnext-btn" href="https://ageldama.github.io/posts/2019-12dec/cl-state-machine-1st-release/">⬅️ First release of cl-state-machine</a>
        
    </span>

    <span class="post-prevnext-side">
        
        <a class="post-prevnext-btn" href="https://ageldama.github.io/posts/2019-11nov/the-dark-side-of-cl-equality/">➡️ (Common Lisp의 어두운 면) Equality</a>
        
    </span>
</nav>

</main>
<footer class="global-footer">
    2026  © <a href='/myself'>ageldama</a> 👾  | Built with <a href="https://gohugo.io">Hugo</a> + <a href="https://github.com/ageldama/young40er-hugo-theme/">young40er theme</a> <code>1771409348</code> | Subscribe <a href="/index.xml" >📡 RSS</a>
</footer>



<script async src="https://www.googletagmanager.com/gtag/js?id=G-YSB7MGHZ4V"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-YSB7MGHZ4V', { cookie_flags: 'SameSite=None;Secure' });
</script>



</div>
    </body>
</html>
